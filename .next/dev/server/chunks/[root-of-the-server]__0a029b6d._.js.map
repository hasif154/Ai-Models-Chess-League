{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/d%20drive%20downloads/Coding/Ai%20chess/app/api/chess/move/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport Groq from \"groq-sdk\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    const { apiKeys, model, role, fen, history } = await req.json();\r\n\r\n    const isGroq = model.includes(\"Groq\") || model.includes(\"llama\") || model.includes(\"mixtral\");\r\n    const apiKey = isGroq ? apiKeys.groq : apiKeys.openrouter;\r\n    const baseUrl = isGroq ? \"https://api.groq.com/openai/v1\" : \"https://openrouter.ai/api/v1\";\r\n\r\n    const systemPrompt = `You are a Grandmaster AI playing a chess match in the \"AI Chess League\".\r\nCurrent FEN: ${fen}\r\nPrevious moves: ${history.join(\", \")}\r\nYou are playing as ${role}.\r\n\r\nYour goal is to win. \r\nYou must output ONLY a JSON object:\r\n{\r\n  \"move\": \"<algebraic move like e4 or Nf3>\",\r\n  \"thoughts\": \"<a natural paragraph of your internal strategic reasoning, no bullets, no headings>\"\r\n}\r\n\r\nIf you believe the position is hopeless, you may output \"resign\" as the move.\r\nStrictly adhere to the JSON format.`;\r\n\r\n    try {\r\n        const response = await fetch(`${baseUrl}/chat/completions`, {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Authorization\": `Bearer ${apiKey}`,\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n                model: model.replace(\" (Groq)\", \"\").replace(\" (Free)\", \"\"),\r\n                messages: [{ role: \"system\", content: systemPrompt }],\r\n                response_format: { type: \"json_object\" },\r\n            }),\r\n        });\r\n\r\n        const data = await response.json();\r\n        const content = JSON.parse(data.choices[0].message.content);\r\n\r\n        return NextResponse.json(content);\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAGO,eAAe,KAAK,GAAgB;IACvC,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;IAE7D,MAAM,SAAS,MAAM,QAAQ,CAAC,WAAW,MAAM,QAAQ,CAAC,YAAY,MAAM,QAAQ,CAAC;IACnF,MAAM,SAAS,SAAS,QAAQ,IAAI,GAAG,QAAQ,UAAU;IACzD,MAAM,UAAU,SAAS,mCAAmC;IAE5D,MAAM,eAAe,CAAC;aACb,EAAE,IAAI;gBACH,EAAE,QAAQ,IAAI,CAAC,MAAM;mBAClB,EAAE,KAAK;;;;;;;;;;mCAUS,CAAC;IAEhC,IAAI;QACA,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,iBAAiB,CAAC,EAAE;YACxD,QAAQ;YACR,SAAS;gBACL,iBAAiB,CAAC,OAAO,EAAE,QAAQ;gBACnC,gBAAgB;YACpB;YACA,MAAM,KAAK,SAAS,CAAC;gBACjB,OAAO,MAAM,OAAO,CAAC,WAAW,IAAI,OAAO,CAAC,WAAW;gBACvD,UAAU;oBAAC;wBAAE,MAAM;wBAAU,SAAS;oBAAa;iBAAE;gBACrD,iBAAiB;oBAAE,MAAM;gBAAc;YAC3C;QACJ;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO;QAE1D,OAAO,6JAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,OAAO,6JAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ"}}]
}